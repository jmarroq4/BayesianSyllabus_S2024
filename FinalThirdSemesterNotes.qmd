---
title: "Weeks 10-15"
---

# Week 10

- Review project details and get updates
- Discuss project 2
- Q&A Session

# Week 11

Tuesday:  Gain clarity on Tuesday for final third of semester

Thursday:  Project demonstration and presentation

Introduce Project 3


# Week 12

## Stan introduction via brms

```{r}
#| echo: TRUE
#| message: FALSE
#| warning: FALSE
#| error: FALSE
#| output: false
#| cache: false

library(brms)
library(tidyverse)

# simulate
set.seed(123)
n <- 100
x <- rnorm(n)
y <- 2*x + rnorm(n)
data <- data.frame(x, y)

# fit
fit <- brm(y ~ x, data = data, chains = 1, iter = 100)

```

```{r}
#| echo: TRUE
#| message: FALSE
#| warning: FALSE
#| error: FALSE

# print the fit
summary(fit)
```


```{r stcode}
#| echo: TRUE
#| message: FALSE
#| warning: FALSE
#| error: FALSE
#| class-output: stan

# extract stan code from brms

writeLines(stancode(fit))
```

```{r stdata}
#| echo: TRUE
#| message: FALSE
#| warning: FALSE
#| error: FALSE
#| cache: false

# extract stan data from brms
standata(fit)
```


## Real life examples and applications - unique to Bayesian analyses

- [ ] [A new look at p-values for RCTs](http://www.stat.columbia.edu/~gelman/research/published/pval_RCTs_rev3.pdf)
- [ ] [A novel clinical trial](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7826635/)
- [ ] [Clinical nutrition research](https://pubmed.ncbi.nlm.nih.gov/37715007/)



# Week 13

We begin our final week of new material by introducing some details that will help you apply Bayesian analyses to your own research.  We will also discuss the final project and how to present your work.  Here are some broad stroke details I wish to discuss:

1.  How to apply Bayesian analyses to your own research
  a.  Ask different questions of your data
  b.  Use different priors (test, try, learn)
  c.  Use different models (distributions, link functions, etc.)
2.  How to present your work
  a.  What to include in your presentation
  b.  What details matter?
  c.  How to answer questions as they arise (post presentation)
3.  How to write up your work
  a.  What to include in your write-up
  b.  What details matter?
  c.  How do you anticipate questions and answer them in your write-up?


# Week 14

Real life examples and applications - unique to Bayesian analyses

## Julia First

1. Install Julia and Friends
  a. [Download Julia](https://julialang.org/downloads/)
  b. [Install Julia](https://julialang.org/downloads/platform/)
  c. [Install IJulia](https://quarto.org/docs/computations/julia.html#installation)
  d. [Install Stan.jl](https://github.com/StanJulia/Stan.jl)
  e. [Install Plots.jl](http://docs.juliaplots.org/latest/)
  
2.  Test your installation
  
Plot function pair (x(u), y(u)). 
See @fig-parametric for an example.

```{julia}
#| label: fig-parametric
#| fig-cap: "Parametric Plots"

using Plots

plot(sin, 
     x->sin(2x), 
     0, 
     2Ï€, 
     leg=false, 
     fill=(0,:lavender))
```  
  

## Julia and Stan

```{julia}
using Stan

# simulate
n = 100
x = randn(n)
y = 2*x + randn(n)

# fit
model = "
data {
  int<lower=0> N;
  vector[N] x;
  vector[N] y;
}
parameters {
  real alpha;
  real beta;
  real<lower=0> sigma;
}
model {
  y ~ normal(alpha + beta * x, sigma);
}
"
data = Dict("N" => n, "x" => x, "y" => y)
fit = stan(model, data = data, iter = 1000, chains = 1)
```

```{julia}
# print the fit
println(fit)
```

```{julia}
# extract stan code from brms
println(stancode(fit))
```

```{julia}
# extract stan data from brms
println(standata(fit))
  
```



# Week 15

Final project presentation
